# プロキシ生成ツール

このプロジェクトは、カードのプロキシ（代替カード）を印刷用PDFとして生成するツールです。  
PyQt5 を用いたGUIで画像ファイルの選択、印刷枚数の設定、プレビュー、PDF生成が可能です。  
また、PDF生成時に A4 と A3 のページサイズをUI上で切り替えることができます。

## 特徴

- **画像の追加と管理**  
  - 画像ファイルを複数選択してテーブルに追加。
  - 各画像ごとに印刷枚数を個別に設定（初期値は 1）。
  - テーブル上で不要な画像を選択して削除可能。
  - 画像名はファイルパスではなくファイル名のみ表示し、ダブルクリックで画像プレビューが可能。

- **PDF生成**  
  - ReportLab を使用して画像をカードサイズに合わせたグリッド状に配置し、PDFに出力。
  - ページサイズは A4（縦向き）または A3（横向き）から選択可能。
    - **A4:** 3列×3行（計9枚／ページ）
    - **A3:** 6列×3行（計18枚／ページ）
  - 画像ごとの印刷枚数設定により、同じ画像を複数枚出力可能。
  - ガイドライン（余白用矩形）を描画し、カードの区切りがわかるレイアウトを実現。
  - プレビュー機能で、生成前にPDF内容を確認できます。

- **保存機能**  
  - PDF生成時、保存ダイアログに初期ファイル名 "output.pdf" を設定しています。

## 必要な環境

- Python 3.x
- [PyQt5](https://pypi.org/project/PyQt5/)
- [ReportLab](https://www.reportlab.com/opensource/)

## インストール

必要なパッケージをpipでインストールします。

```bash
pip install PyQt5 reportlab
```

## 使い方

1. **アプリケーションの起動**  
   ターミナルまたはコマンドプロンプトで以下のコマンドを実行してアプリケーションを起動します。

   ```bash
   python your_script.py
   ```

2. **画像の追加**  
   - 「画像追加」ボタンをクリックして、印刷対象の画像ファイル（.jpg, .png）を選択します。
   - 追加された画像はテーブルにファイル名のみが表示され、実際のパスは内部で保持されます。

3. **印刷枚数の設定**  
   - 各画像ごとに表示されるスピンボックスで印刷枚数を設定します。

4. **画像のプレビュー**  
   - テーブルの画像名をダブルクリックすると、選択した画像が別ウィンドウでプレビュー表示されます。

5. **ページサイズの選択**  
   - 画面上部のコンボボックスから、A4 または A3 のページサイズを選択します。
   - A4 は 3列×3行（計9枚／ページ）、A3 は 6列×3行（計18枚／ページ）のレイアウトでPDFに出力されます。

6. **プレビューとPDF生成**  
   - 「プレビュー」ボタンで、設定内容に基づいた一時PDFを生成し、既定のPDFビューアで内容を確認できます。
   - 「生成」ボタンを押すと、保存ダイアログが表示され、PDFファイルとして保存されます。  
     初期ファイル名は "output.pdf" です。

## コード構成

- **GUI部分**  
  - PyQt5 により、画像の追加・削除、印刷枚数の設定、プレビュー、PDF生成、ページサイズの切り替えが行えます。

- **PDF生成部分**  
  - ReportLab を用いて、指定したレイアウト（グリッド、ガイドライン）で画像を配置し、PDFを生成します。  
  - `create_pdf` 関数内でページサイズに応じたレイアウトパラメータ（グリッド数、開始位置、カードサイズ、余白）が設定されています。
